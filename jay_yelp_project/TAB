import sqlite3
import json

DB_NAME = "../data/yelp_IN_PA.db"
DATA_FILE = "../data/yelp_in_pa_business.json"

print("Creating database...")

conn = sqlite3.connect(DB_NAME)
cursor = conn.cursor()

cursor.execute("""
CREATE TABLE IF NOT EXISTS businesses (
    business_id TEXT PRIMARY KEY,
    name TEXT,
    city TEXT,
    state TEXT,
    stars REAL,
    review_count INTEGER
)
""")

with open(DATA_FILE, "r") as file:
    for line in file:
        b = json.loads(line)
        cursor.execute("""
        INSERT OR IGNORE INTO businesses VALUES (?, ?, ?, ?, ?, ?)
        """, (
            b["business_id"],
            b["name"],
            b["city"],
            b["state"],
            b["stars"],
            b["review_count"]
        ))

conn.commit()
conn.close()

print("Database ready.")

